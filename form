# VAULTRON FORM!

export CONSUL_HTTP_ADDR="localhost:8500"
export VAULT_ADDR="http://localhost:8200"

_apply() {
    terraform apply -state=./tfstate/terraform.tfstate > /dev/null 2>&1;
}

_plan() {
    terraform plan -state=./tfstate/terraform.tfstate > /dev/null 2>&1;
}

echo "âœ¨  Form Vaultron ..."
echo "âœ¨  Set CONSUL_HTTP_ADDR to ${CONSUL_HTTP_ADDR}"
echo "âœ¨  Set VAULT_ADDR to ${VAULT_ADDR}"

if _plan; then
    if _apply; then
        echo "ðŸ¤–  Vaultron formed!"
    else
        echo "ðŸš«  Vaultron cannot form! Check `terraform apply` output."
    fi
else
    echo "ðŸš«  Vaultron cannot form! Check `terraform plan` output."
fi
